{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
<!-- Fullscreen background -->
<div class="relative min-h-screen bg-cover bg-center flex items-center justify-center" 
     style="background-image: url('https://images.unsplash.com/photo-1517849845537-4d257902454a?w=1600&q=80');">

  <!-- Overlay for readability -->
  <div class="absolute inset-0 bg-white/40 backdrop-blur-md"></div>

  <!-- Signup Card -->
  <div class="relative z-10 w-full max-w-3xl mx-auto rounded-2xl shadow-xl bg-white/60 backdrop-blur-lg border border-white/30 p-8 sm:p-10">
    <h2 class="text-3xl font-extrabold text-center text-gray-800 mb-6">Create Your Account</h2>

    <!-- Progress Bar -->
    <div class="w-full bg-gray-200 rounded-full h-2 mb-8">
      <div id="progress-bar" class="bg-pink-500 h-2 rounded-full w-0 transition-all duration-300"></div>
    </div>

    <form id="signup-form" method="POST" enctype="multipart/form-data" class="space-y-6">
      {% csrf_token %}

      <!-- Step 1 -->
      <div class="form-step">
        {{ form.username|as_crispy_field }}
        {{ form.email|as_crispy_field }}
        <button type="button" class="next-btn bg-pink-600 hover:bg-pink-700 text-white font-semibold py-2 px-5 rounded-lg mt-4 w-full sm:w-auto">Next</button>
      </div>

      <!-- Step 2 -->
      <div class="form-step hidden">
        {{ form.password1|as_crispy_field }}
        {{ form.password2|as_crispy_field }}
        <div class="flex justify-between mt-4">
          <button type="button" class="prev-btn bg-gray-400 text-white py-2 px-4 rounded-lg">Back</button>
          <button type="button" class="next-btn bg-pink-600 hover:bg-pink-700 text-white py-2 px-4 rounded-lg">Next</button>
        </div>
      </div>

      <!-- Step 3 -->
      <div class="form-step hidden">
        {{ form.phone_number|as_crispy_field }}
        {{ form.date_of_birth|as_crispy_field }}
        <div class="flex justify-between mt-4">
          <button type="button" class="prev-btn bg-gray-400 text-white py-2 px-4 rounded-lg">Back</button>
          <button type="button" class="next-btn bg-pink-600 hover:bg-pink-700 text-white py-2 px-4 rounded-lg">Next</button>
        </div>
      </div>

      <!-- Step 4 -->
      <div class="form-step hidden">
        {{ form.bio|as_crispy_field }}
        {{ form.gender|as_crispy_field }}
        <div class="flex justify-between mt-4">
          <button type="button" class="prev-btn bg-gray-400 text-white py-2 px-4 rounded-lg">Back</button>
          <button type="button" class="next-btn bg-pink-600 hover:bg-pink-700 text-white py-2 px-4 rounded-lg">Next</button>
        </div>
      </div>

      <!-- Step 5 -->
      <div class="form-step hidden">
        {{ form.country|as_crispy_field }}
        {{ form.profile_pic|as_crispy_field }}
        <div class="flex justify-between mt-4">
          <button type="button" class="prev-btn bg-gray-400 text-white py-2 px-4 rounded-lg">Back</button>
          <button type="button" class="next-btn bg-pink-600 hover:bg-pink-700 text-white py-2 px-4 rounded-lg">Next</button>
        </div>
      </div>

      <!-- Step 6 -->
      <div class="form-step hidden">
        {{ form.interests|as_crispy_field }}
        {{ form.hobbies|as_crispy_field }}
        {{ form.want_kids|as_crispy_field }}
        {{ form.relationship_goal|as_crispy_field }}
        {{ form.lifestyle|as_crispy_field }}
        <div class="flex justify-between mt-4">
          <button type="button" class="prev-btn bg-gray-400 text-white py-2 px-4 rounded-lg">Back</button>
          <button type="submit" class="bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded-lg font-semibold">Submit</button>
        </div>
      </div>
    </form>

    <!-- Loader -->
    <div id="loader-overlay" class="fixed inset-0 bg-gray-900 bg-opacity-60 flex items-center justify-center opacity-0 pointer-events-none transition-opacity duration-500 z-50">
      <div class="w-16 h-16 border-4 border-pink-500 border-t-transparent rounded-full animate-spin"></div>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const steps = document.querySelectorAll(".form-step");
  let currentStep = 0;

  function showStep(index) {
    steps.forEach((step, i) => step.classList.toggle("hidden", i !== index));
    document.getElementById("progress-bar").style.width = ((index + 1) / steps.length) * 100 + "%";
  }

  document.querySelectorAll(".next-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      if (currentStep < steps.length - 1) {
        currentStep++;
        showStep(currentStep);
      }
    });
  });

  document.querySelectorAll(".prev-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      if (currentStep > 0) {
        currentStep--;
        showStep(currentStep);
      }
    });
  });

  document.getElementById("signup-form").addEventListener("submit", () => {
    const loader = document.getElementById("loader-overlay");
    loader.classList.remove("opacity-0", "pointer-events-none");
    loader.classList.add("opacity-100");
  });

  showStep(currentStep);
});
</script>
{% endblock %}

